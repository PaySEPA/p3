<div class="section section-budgets">
  <h3 class="headline">
    Budgets
    <span data-ng-hide="model.state.budgets.loading" class="btn-group pull-right">
      <a href="#" class="btn dropdown-toggle" data-toggle="dropdown">
        <i class="icon-reorder"></i>
      </a>
      <ul class="dropdown-menu pull-right">
        <li>
          <a data-ng-click="model.modals.showAddBudget=true"><i class="icon-plus"></i> Add Budget</a>
        </li>
      </ul>
    </span>
    <span data-ng-show="model.state.budgets.loading" class="pull-right">
      <span data-spinner="model.state.budgets.loading" data-spinner-class="h3-spinner"></span>
    </span>
  </h3>
  <table class="table table-condensed" data-ng-show="!model.state.budgets.loading && model.budgets.length > 0">
    <thead>
      <tr>
        <th class="name">Budget</th>
        <th class="money">Balance</th>
        <th>Refill</th>
        <th class="action">Action</th>
      </tr>
    </thead>
    <tbody>
      <tr data-ng-repeat="budget in model.budgets | orderBy:'label'"
        class="budget"
        data-fadeout="budget.deleted">
        <!-- Label -->
        <td class="name">
          <a href="{{budget.id}}">{{budget.label}}</a>
        </td>
        <!-- Balance -->
        <td class="money">
          <div data-budget-bar="budget"></div>
        </td>
        <!-- Refresh -->
        <td data-ng-switch="model.getBudgetRefreshDuration(budget)">
          <span data-ng-switch-when="never">Never</span>
          <span data-ng-switch-when="PT1H">Hourly</span>
          <span data-ng-switch-when="P1D">Daily</span>
          <span data-ng-switch-when="P1W">Weekly</span>
          <span data-ng-switch-when="P1M">Monthly</span>
          <span data-ng-switch-when="P1Y">Yearly</span>
        </td>
        <!-- Action -->
        <td class="action">
          <action-menu>
            <ul class="dropdown-menu stackable-menu">
              <li>
                <a class="stackable-cancel" data-ng-click="model.modals.budget=budget; model.modals.showEditBudget=true">
                  <i class="icon-pencil"></i> Edit
                </a>
              </li>
              <li class="divider"></li>
              <li class="btn-danger">
                <a class="stackable-cancel" data-ng-click="model.deleteBudget(budget)">
                  <i class="icon-remove"></i> Delete
                </a>
              </li>
            </ul>
          </action-menu>
        </td>
      </tr>
    </tbody>
  </table>
  <!-- Delete budget alert -->
  <stackable-modal stackable="model.showDeleteBudgetAlert"
    stackable-closed="model.confirmDeleteBudget(err, result)">
    <div data-alert-modal
      data-modal-header="Warning"
      data-modal-ok="Delete"
      data-modal-cancel="Cancel">
      <p>Are you sure that you want to delete this budget?</p>
      <div data-budget-selector
        data-selected="model.budgetToDelete"
        data-invalid="invalidBudget" data-fixed="true"></div>
  </stackable-modal>
  <div data-ng-show="!model.state.budgets.loading && model.budgets.length == 0">
    <p class="center">You have no budgets for this identity.</p>
  </div>
  <stackable-modal stackable="model.modals.showEditBudget">
    <div data-edit-budget-modal data-budget="model.modals.budget"></div>
  </stackable-modal>
  <stackable-modal stackable="model.modals.showAddBudget">
    <div data-add-budget-modal></div>
  </stackable-modal>
</div>
